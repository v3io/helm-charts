{{- if .Values.v3io.functions.create }}
{{- range $key, $val := .Values.v3io.functions.items }}
apiVersion: nuclio.io/v1beta1
kind: Function
metadata:
  name: {{ $val.name }}
spec:
  handler: {{ $val.handler }}
  image: {{ $val.image.repository }}:{{ $val.image.tag }}
  maxReplicas: 1
  minReplicas: 1
  runtime: {{ $val.runtime }}
  env:
    - name: WEBAPI_URL
      value: {{ .Values.v3io.webApi }}
{{- if $val.env }}
{{- range $key, $val := $val.env }}
    - name: {{ $val.name }}
      value: {{ $val.value }}
{{- end }}
{{- end }}
status:
  state: waitingForResourceConfiguration
---
{{- end }}
{{- end }}
